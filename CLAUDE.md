# 纯文本差异对比工具 - 项目开发计划

> **项目名称**：文本差异对比工具
> **技术栈**：Vue3 + Vite + TypeScript + diff-match-patch + UnoCSS + Element Plus
> **开发阶段**：从0到1完整搭建
> **创建日期**：2025-11-22

## 📋 项目概述

这是一个基于Web的纯文本差异对比工具，专注于**精细化文本差异分析**，使用diff-match-patch算法实现字符级别的精确差异检测。

**核心价值**：
- 字符级精确差异检测（非行级）
- 可视化差异展示（红绿蓝三色编码）
- HTML导出功能
- 跨平台兼容性

## 🎯 开发计划

### 第一阶段：项目基础搭建 (1-2天)

#### 1.1 项目初始化
- [x] 创建项目目录结构
- [ ] 初始化Vue3 + Vite + TypeScript项目
- [ ] 配置基础开发环境（ESLint、Prettier）
- [ ] 配置Git仓库和提交规范

#### 1.2 核心依赖安装
- [ ] 安装UI框架：Element Plus
- [ ] 安装CSS框架：UnoCSS
- [ ] 安装核心算法：diff-match-patch
- [ ] 安装TypeScript类型定义
- [ ] 配置路由系统（Vue Router）

#### 1.3 项目结构搭建
```
src/
├── components/          # 公共组件
│   ├── DiffViewer/     # 差异查看组件
│   ├── FileUploader/   # 文件上传组件
│   └── TextInput/      # 文本输入组件
├── views/              # 页面视图
│   ├── InputView.vue   # 数据输入页面
│   └── ResultView.vue  # 结果展示页面
├── utils/              # 工具函数
│   ├── diffAlgorithm.ts # 差异算法封装
│   ├── textProcessor.ts # 文本预处理
│   └── htmlExporter.ts  # HTML导出
├── types/              # TypeScript类型定义
│   └── diff.ts         # 差异相关类型
└── router/             # 路由配置
    └── index.ts
```

### 第二阶段：核心功能实现 (3-4天)

#### 2.1 数据输入页面 (InputView.vue)
- [ ] 文件上传组件：支持.md/.csv/.txt格式
- [ ] 文件验证：格式检查、大小限制（10MB）
- [ ] 文本输入组件：大文本框输入
- [ ] 混合输入支持：文件+文本组合
- [ ] 实时验证和错误提示
- [ ] 对比按钮状态管理

#### 2.2 文本处理逻辑 (textProcessor.ts)
- [ ] 换行符标准化：统一转换为`\n`
- [ ] 文本内容拉平：多行转单行字符串
- [ ] 跨平台兼容性处理
- [ ] 预处理错误捕获

#### 2.3 差异算法集成 (diffAlgorithm.ts)
- [ ] diff-match-patch库集成
- [ ] 算法输入预处理
- [ ] 差异序列计算
- [ ] 编辑距离获取
- [ ] 差异数据结构化
- [ ] 性能优化（大文件处理）

#### 2.4 差异可视化组件 (DiffViewer.vue)
- [ ] 差异结果渲染引擎
- [ ] 颜色编码系统：
  - 🔴 红色背景：删除内容
  - 🟢 绿色背景：新增内容
  - 🔵 蓝色背景：修改内容
- [ ] 格式还原：原始文本格式回溯
- [ ] 响应式布局设计

### 第三阶段：结果展示和导出 (2-3天)

#### 3.1 差异查看页面 (ResultView.vue)
- [ ] 差异结果完整展示
- [ ] 工具栏设计：
  - 返回按钮
  - 导出HTML按钮
  - 差异统计信息
- [ ] 页面布局优化
- [ ] 移动端适配

#### 3.2 HTML导出功能 (htmlExporter.ts)
- [ ] 导出按钮实现
- [ ] HTML文档结构构建
- [ ] CSS样式内联处理
- [ ] 元数据信息包含（时间、文件名、统计）
- [ ] 文件下载触发
- [ ] 文件名规范化（含时间戳）

### 第四阶段：错误处理和优化 (1-2天)

#### 4.1 完善错误处理机制
- [ ] 文件上传错误处理
- [ ] 数据验证错误处理
- [ ] 计算过程错误处理
- [ ] 全局错误边界设置
- [ ] 用户友好错误提示

#### 4.2 用户体验优化
- [ ] Loading状态设计
- [ ] 操作反馈优化
- [ ] 界面交互细节完善
- [ ] 性能监控和优化

## 🔧 技术实现要点

### 核心算法策略
- **一期**：使用成熟diff-match-patch库，确保功能稳定性
- **二期规划**：基于使用经验，考虑自研优化算法

### 文本处理规范
```typescript
// 标准化换行符处理
function normalizeText(text: string): string {
  return text.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
}
```

### 差异数据结构
```typescript
interface DiffRecord {
  position: number;    // 差异位置
  type: 'add' | 'delete' | 'modify';  // 差异类型
  content: string;     // 差异内容
  originalContent?: string; // 原始内容（修改时）
}
```

### UI设计原则
- **极简界面**：避免复杂配置，专注核心功能
- **一键操作**：简化用户操作路径
- **结果导向**：快速从输入到结果的完整流程

## 📊 里程碑计划

| 阶段 | 时间 | 主要交付物 | 成功标准 |
|------|------|------------|----------|
| 第一阶段 | 1-2天 | 项目基础架构 | 项目可启动，依赖安装完成 |
| 第二阶段 | 3-4天 | 核心功能 | 可输入文本并显示差异结果 |
| 第三阶段 | 2-3天 | 完整功能 | 可导出HTML，功能完整可用 |
| 第四阶段 | 1-2天 | 优化完善 | 错误处理完善，用户体验良好 |

## 🚀 下一步行动

1. **立即执行**：项目初始化，创建Vue3+Vite项目
2. **优先级**：先实现基础功能，后优化用户体验
3. **测试策略**：每个阶段完成后进行功能验证
4. **文档同步**：及时更新技术文档和用户使用说明

## 📝 开发备注

- 重点关注文本处理的跨平台兼容性
- diff-match-patch算法的正确集成是项目成功关键
- HTML导出功能需要保持样式一致性
- 错误处理要用户友好，避免技术术语
- 响应式设计确保移动端体验

---

**项目启动时间**：2025-11-22
**预计完成时间**：2025-11-30
**当前状态**：准备开始第一阶段 - 项目基础搭建