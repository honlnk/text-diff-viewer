# 纯文本差异对比工具 - 项目开发计划

> **项目名称**：文本差异对比工具
> **技术栈**：Vue3 + Vite + TypeScript + diff-match-patch + UnoCSS + Element Plus
> **开发阶段**：从0到1完整搭建
> **创建日期**：2025-11-22

## 📋 项目概述

这是一个基于Web的纯文本差异对比工具，专注于**精细化文本差异分析**，使用diff-match-patch算法实现字符级别的精确差异检测。

**核心价值**：
- 字符级精确差异检测（非行级）
- 可视化差异展示（红绿蓝三色编码）
- HTML导出功能
- 跨平台兼容性

## 🎯 开发计划

### 第一阶段：项目基础搭建 ✅ **已完成**

#### 1.1 项目初始化
- [x] 创建项目目录结构
- [x] 初始化Vue3 + Vite + TypeScript项目
- [x] 配置基础开发环境（ESLint、Prettier）
- [x] 配置Git仓库和提交规范

#### 1.2 核心依赖安装
- [x] 安装UI框架：Element Plus 2.11.8
- [x] 安装CSS框架：UnoCSS 0.58.9
- [x] 安装核心算法：diff-match-patch 1.0.5
- [x] 安装TypeScript类型定义
- [x] 配置路由系统（Vue Router 4.6.3）

#### 1.3 开发环境配置 ✅ **已完成**
- [x] 配置vite.config.ts (支持别名、自动导入)
- [x] 配置uno.config.ts (预设、快捷方式)
- [x] 配置tsconfig.json (严格模式、路径映射)
- [x] 配置ESLint和Prettier规则
- [x] 配置package.json构建脚本

#### 1.4 项目结构搭建 ✅ **已完成**
- [x] 创建基础目录结构
- [x] 创建TypeScript类型定义 (src/types/diff.ts)
- [x] 配置路由系统 (src/router/index.ts)
- [x] 创建主应用组件 (src/App.vue, src/main.ts)

#### 1.5 基础页面实现 ✅ **已完成**
- [x] 创建InputView.vue (数据输入页面)
- [x] 创建ResultView.vue (结果展示页面框架)
- [x] 实现文件上传和文本输入功能
- [x] 实现基础错误处理和验证

#### 1.6 验证测试 ✅ **已完成**
- [x] 项目构建成功 (`pnpm run build`)
- [x] 开发服务器正常启动 (`pnpm run dev`)
- [x] TypeScript编译无错误
- [x] 所有依赖正确工作

---

### 第二阶段：核心功能实现 🔄 **进行中**

#### 2.1 数据输入页面 (InputView.vue) ✅ **已完成**
- [x] 文件上传组件：支持.md/.csv/.txt格式
- [x] 文件验证：格式检查、大小限制（10MB）
- [x] 文本输入组件：大文本框输入
- [x] 混合输入支持：文件+文本组合
- [x] 实时验证和错误提示
- [x] 对比按钮状态管理

#### 2.2 文本处理逻辑 (textProcessor.ts)
- [ ] 换行符标准化：统一转换为`\n`
- [ ] 文本内容拉平：多行转单行字符串
- [ ] 跨平台兼容性处理
- [ ] 预处理错误捕获

#### 2.3 差异算法集成 (diffAlgorithm.ts)
- [ ] diff-match-patch库集成
- [ ] 算法输入预处理
- [ ] 差异序列计算
- [ ] 编辑距离获取
- [ ] 差异数据结构化
- [ ] 性能优化（大文件处理）

#### 2.4 差异可视化组件 (DiffViewer.vue)
- [ ] 差异结果渲染引擎
- [ ] 颜色编码系统：
  - 🔴 红色背景：删除内容
  - 🟢 绿色背景：新增内容
  - 🔵 蓝色背景：修改内容
- [ ] 格式还原：原始文本格式回溯
- [ ] 响应式布局设计

### 第三阶段：结果展示和导出 (2-3天)

#### 3.1 差异查看页面 (ResultView.vue)
- [ ] 差异结果完整展示
- [ ] 工具栏设计：
  - 返回按钮
  - 导出HTML按钮
  - 差异统计信息
- [ ] 页面布局优化
- [ ] 移动端适配

#### 3.2 HTML导出功能 (htmlExporter.ts)
- [ ] 导出按钮实现
- [ ] HTML文档结构构建
- [ ] CSS样式内联处理
- [ ] 元数据信息包含（时间、文件名、统计）
- [ ] 文件下载触发
- [ ] 文件名规范化（含时间戳）

### 第四阶段：错误处理和优化 (1-2天)

#### 4.1 完善错误处理机制
- [ ] 文件上传错误处理
- [ ] 数据验证错误处理
- [ ] 计算过程错误处理
- [ ] 全局错误边界设置
- [ ] 用户友好错误提示

#### 4.2 用户体验优化
- [ ] Loading状态设计
- [ ] 操作反馈优化
- [ ] 界面交互细节完善
- [ ] 性能监控和优化

## 🔧 技术实现要点

### 核心算法策略
- **一期**：使用成熟diff-match-patch库，确保功能稳定性
- **二期规划**：基于使用经验，考虑自研优化算法

### 文本处理规范
```typescript
// 标准化换行符处理
function normalizeText(text: string): string {
  return text.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
}
```

### 差异数据结构
```typescript
interface DiffRecord {
  position: number;    // 差异位置
  type: 'add' | 'delete' | 'modify';  // 差异类型
  content: string;     // 差异内容
  originalContent?: string; // 原始内容（修改时）
}
```

### UI设计原则
- **极简界面**：避免复杂配置，专注核心功能
- **一键操作**：简化用户操作路径
- **结果导向**：快速从输入到结果的完整流程

## 📊 里程碑计划

| 阶段 | 时间 | 主要交付物 | 成功标准 | 状态 |
|------|------|------------|----------|------|
| 第一阶段 | 1-2天 | 项目基础架构 | 项目可启动，依赖安装完成 | ✅ **已完成** |
| 第二阶段 | 3-4天 | 核心功能 | 可输入文本并显示差异结果 | 🔄 **进行中** |
| 第三阶段 | 2-3天 | 完整功能 | 可导出HTML，功能完整可用 | ⏳ **待开始** |
| 第四阶段 | 1-2天 | 优化完善 | 错误处理完善，用户体验良好 | ⏳ **待开始** |

## 🚀 当前项目状态 (2025-11-22)

### ✅ 第一阶段完成总结
- **完成时间**: 约3小时
- **主要成果**:
  - 完整的Vue3 + TypeScript + Vite开发环境
  - 所有核心依赖正确安装和配置
  - 基础UI界面框架完成
  - 项目可正常构建和运行

### 🔄 第二阶段进行中
- **当前进度**: 约30% (数据输入页面已完成)
- **下一步**: 实现diff算法集成和差异可视化

### 📈 技术栈就绪度
- **前端框架**: ✅ 100% (Vue3 + TypeScript)
- **UI组件**: ✅ 100% (Element Plus + UnoCSS)
- **差异算法**: ✅ 100% (diff-match-patch已安装)
- **构建工具**: ✅ 100% (Vite + 完整配置)

### 📂 已实现功能
1. ✅ 文件上传 (.txt, .md, .csv)
2. ✅ 文本直接输入
3. ✅ 文件验证 (格式、大小限制)
4. ✅ 基础错误处理
5. ✅ 响应式布局
6. ✅ 路由系统

### 🔄 待实现功能
1. ⏳ diff算法集成
2. ⏳ 字符级差异可视化
3. ⏳ HTML导出功能
4. ⏳ 性能优化

## 📝 开发备注

- 重点关注文本处理的跨平台兼容性
- diff-match-patch算法的正确集成是项目成功关键
- HTML导出功能需要保持样式一致性
- 错误处理要用户友好，避免技术术语
- 响应式设计确保移动端体验

---

**项目启动时间**：2025-11-22
**第一阶段完成时间**：2025-11-22 (约3小时)
**预计完成时间**：2025-11-30
**当前状态**：✅ 第一阶段已完成，正在进入第二阶段 - 核心功能实现